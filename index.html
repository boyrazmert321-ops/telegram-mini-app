<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Pro Gaming Hub</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #0d1117;
            --card-bg: #161b22;
            --accent-color: #7d4cf6;
            --text-main: #ffffff;
            --text-dim: #8b949e;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Inter', -apple-system, sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* √úst Profil Barƒ± */
        .header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            border-bottom: 1px solid #30363d;
        }

        .user-pill {
            background: #21262d;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            border: 1px solid var(--accent-color);
        }

        /* Oyun Alanƒ± */
        #game-container {
            flex-grow: 1;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-end;
            background: radial-gradient(circle at top, #1c2128 0%, #0d1117 100%);
        }

        canvas {
            display: block;
            width: 100%;
            max-width: 400px;
            touch-action: none;
        }

        /* Alt Men√º (Pro G√∂r√ºn√ºm) */
        .nav-bar {
            height: 70px;
            background: var(--card-bg);
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-top: 1px solid #30363d;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-dim);
            font-size: 11px;
            text-decoration: none;
        }

        .nav-item.active { color: var(--accent-color); }

        .nav-icon { font-size: 20px; margin-bottom: 4px; }

        .score-display {
            position: absolute;
            top: 20px;
            font-size: 40px;
            font-weight: 900;
            color: var(--accent-color);
            text-shadow: 0 0 15px rgba(125, 76, 246, 0.5);
        }

        #message {
            position: absolute;
            bottom: 100px;
            color: var(--text-dim);
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="header">
        <div id="username" class="user-pill">Oyuncu</div>
        <div id="balance" style="color: #ecf0f1;">üí∞ <span id="score-val">0</span></div>
    </div>

    <div id="game-container">
        <div class="score-display" id="current-score">0</div>
        <div id="message">Ekrana Dokun ve Bloƒüu Bƒ±rak!</div>
        <canvas id="towerCanvas"></canvas>
    </div>

    <nav class="nav-bar">
        <a href="#" class="nav-item active"><span class="nav-icon">üéÆ</span>Oyun</a>
        <a href="#" class="nav-item"><span class="nav-icon">üèÜ</span>Liderler</a>
        <a href="#" class="nav-item"><span class="nav-icon">üë•</span>Arkada≈ülar</a>
        <a href="#" class="nav-item"><span class="nav-icon">‚öôÔ∏è</span>Ayarlar</a>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.backgroundColor = "#0d1117";
        tg.headerColor = "#161b22";

        if (tg.initDataUnsafe?.user) {
            document.getElementById('username').innerText = tg.initDataUnsafe.user.first_name;
        }

        // --- Bƒ∞NA Dƒ∞KME OYUNU LOGIC ---
        const canvas = document.getElementById('towerCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth > 400 ? 400 : window.innerWidth;
        canvas.height = 400;

        let score = 0;
        let blocks = [];
        let currentBlock = { x: 0, y: 0, w: 100, h: 30, dir: 1, speed: 3 };
        let gameState = 'playing';

        function init() {
            blocks = [{ x: (canvas.width-100)/2, y: canvas.height - 30, w: 100, h: 30 }];
            newBlock();
            animate();
        }

        function newBlock() {
            let lastBlock = blocks[blocks.length - 1];
            currentBlock = {
                x: 0,
                y: lastBlock.y - 30,
                w: lastBlock.w,
                h: 30,
                dir: 1,
                speed: 3 + (blocks.length * 0.2)
            };
        }

        function animate() {
            if (gameState !== 'playing') return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // √áizilmi≈ü bloklar
            blocks.forEach((b, i) => {
                ctx.fillStyle = i === 0 ? '#30363d' : `hsl(${260 + i*5}, 70%, 60%)`;
                ctx.fillRect(b.x, b.y, b.w, b.h);
            });

            // Hareketli blok
            ctx.fillStyle = '#7d4cf6';
            ctx.fillRect(currentBlock.x, currentBlock.y, currentBlock.w, currentBlock.h);

            currentBlock.x += currentBlock.speed * currentBlock.dir;
            if (currentBlock.x + currentBlock.w > canvas.width || currentBlock.x < 0) {
                currentBlock.dir *= -1;
            }

            requestAnimationFrame(animate);
        }

        window.addEventListener('touchstart', (e) => {
            if (gameState !== 'playing') {
                score = 0;
                gameState = 'playing';
                init();
                return;
            }

            let lastBlock = blocks[blocks.length - 1];
            
            // √úst √ºste gelme kontrol√º
            if (currentBlock.x > lastBlock.x + lastBlock.w || currentBlock.x + currentBlock.w < lastBlock.x) {
                gameState = 'over';
                document.getElementById('message').innerText = "EYVAH! Yƒ±kƒ±ldƒ±. Tekrar Dene.";
                tg.HapticFeedback.notificationOccurred('error');
            } else {
                // Bloƒüu sabitle
                blocks.push({...currentBlock});
                score++;
                document.getElementById('current-score').innerText = score;
                document.getElementById('score-val').innerText = score * 10;
                tg.HapticFeedback.impactOccurred('medium');
                
                if (blocks.length > 5) {
                    blocks.forEach(b => b.y += 30);
                }
                newBlock();
            }
        });

        init();
    </script>
</body>
</html>
